<!-- 智能体卡片组件 -->
<template>
	<view class='container' hover-class="container-active" @click.prevent="handleClick">
		<view class='agent-icon'>
			<image :src="currentIcon" class='image' @error="handleImageError" />
		</view>
		<view class='info-box'>
			<text class='agent-name text-ellipsis'>{{name}}</text>
			<text class='agent-description text-ellipsis' v-if="description">{{description}}</text>
		</view>
	</view>
</template>

<script setup lang="uts">
	import agentImage from '@/static/assets/agent_image.png'

	interface AgentComponentProps {
		// 图标
		icon: string
		// 名称
		name:string
		// 描述
		description:string
	}

	const props = defineProps<AgentComponentProps>()
		
	// 当前显示的图标，默认使用传入的 icon
	const currentIcon = ref<string>(props.icon)
		
	const emit = defineEmits(['click'])

	// 图片加载错误时触发，切换为默认图片
	const handleImageError = () => {
		currentIcon.value = agentImage
	}

	const handleClick = () => {
		emit('click')
	}
</script>

<style scoped lang="scss">
	.container {
		height: 150rpx;
		gap: 24rpx;
		display: flex;
		flex-direction: row;
		align-items: center;
		padding: 0 16rpx 0 32rpx;
		transform: translateZ(0);
		transition: background-color 0.3s ease;

		&-active {
			background-color: rgba(12, 20, 102, 0.04);
		}
		
		.agent-icon {
			width: 96rpx;
			height: 96rpx;
			border-radius: 50%;
			flex-shrink: 0;
			overflow: hidden;
			position: relative;
			.image{
				width: 106%;
				height: 106%;
				position: absolute;
				left: -3%;
				top: -3%;
			}
		}

		.info-box {
			height: 150rpx;
			flex: 1;
			gap: 8rpx;
			display: flex;
			flex-direction: column;
			justify-content: center;
			overflow: hidden;
			border-bottom: 1rpx solid rgba(12, 20, 102, 0.04);

			.agent-name {
				font-size: 32rpx;
				font-weight: 600;
				color: #15171F;
			}

			.agent-description {
				font-size: 28rpx;
				color: rgba(21, 23, 31, 0.70);
				line-height: 44rpx;
				font-weight: 400;
			}
		}
	}
</style>