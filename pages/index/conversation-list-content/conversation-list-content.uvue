<template>
  <view class="conversation-list h-full">
    <scroll-view class="h-full" scroll-y>
      <view class="list-wrapper">
        <view
          class="conversation-item"
          v-for="item in conversationList"
          :key="item.id"
          @click="handleItemClick(item)"
        >
          <view class="item-content">
            <view class="title-row">
              <text class="conversation-title">{{ item.title }}</text>
              <text class="time-label">{{ item.timeAgo }}</text>
            </view>
            <view class="bottom-row">
              <text class="agent-name">{{ item.agentName }}</text>
              <view v-if="item.isRunning" class="status-tag">
                <text class="status-text">执行中</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</template>

<script setup lang="uts">
  // 定义会话项接口
  interface ConversationItem {
    id: string;
    title: string;
    agentName: string;
    timeAgo: string;
  }

  // Props 定义
  interface Props {
  }

  const props = withDefaults(defineProps<Props>(), {
  });

  // Emits 定义
  const emit = defineEmits<{
    (e: "conversation-click", item: ConversationItem): void;
  }>();

  // 会话列表数据（静态示例数据）
  const conversationList = ref<ConversationItem[]>([
    {
      id: "1",
      title: "帮我分析一下2025年财报数据",
      agentName: "Nuwax",
      timeAgo: "5分钟前",
      isRunning: true, // 执行中
    },
    {
      id: "2",
      title: "翻译这段英文技术文档",
      agentName: "翻译助手",
      timeAgo: "15分钟前",
    },
    {
      id: "3",
      title: "创建一个用户数据分析报表",
      agentName: "待办助理",
      timeAgo: "1小时前",
    },
    {
      id: "4",
      title: "生成一张科幻风格的AI图片",
      agentName: "AI图片生成大师",
      timeAgo: "2小时前",
    },
    {
      id: "5",
      title: "如何使用Python进行数据可视化",
      agentName: "Nuwax",
      timeAgo: "3小时前",
    },
    {
      id: "6",
      title: "帮我写一个网页登录功能",
      agentName: "女娲助手",
      timeAgo: "5小时前",
    },
    {
      id: "7",
      title: "查询最新的AI技术发展趋势",
      agentName: "女娲助手",
      timeAgo: "昨天",
    },
    {
      id: "8",
      title: "设计一个现代化的后台管理系统界面",
      agentName: "Nuwax",
      timeAgo: "昨天",
    },
    {
      id: "9",
      title: "优化React项目性能的最佳实践",
      agentName: "前端专家",
      timeAgo: "昨天",
    },
    {
      id: "10",
      title: "写一份产品需求文档模板",
      agentName: "产品助手",
      timeAgo: "2天前",
    },
    {
      id: "11",
      title: "帮我生成10个创意的Slogan",
      agentName: "文案大师",
      timeAgo: "2天前",
    },
    {
      id: "12",
      title: "解释一下区块链的工作原理",
      agentName: "Nuwax",
      timeAgo: "3天前",
    },
    {
      id: "13",
      title: "设计一套移动端UI组件库",
      agentName: "设计助手",
      timeAgo: "3天前",
    },
    {
      id: "14",
      title: "分析竞品的用户增长策略",
      agentName: "数据分析师",
      timeAgo: "4天前",
    },
    {
      id: "15",
      title: "生成一份周报总结",
      agentName: "待办助理",
      timeAgo: "5天前",
    },
    {
      id: "16",
      title: "如何搭建微服务架构",
      agentName: "技术顾问",
      timeAgo: "6天前",
    },
    {
      id: "17",
      title: "帮我润色这篇技术博客",
      agentName: "写作助手",
      timeAgo: "1周前",
    },
    {
      id: "18",
      title: "制定Q2季度营销计划",
      agentName: "营销专家",
      timeAgo: "1周前",
    },
    {
      id: "19",
      title: "生成API接口文档",
      agentName: "文档助手",
      timeAgo: "2周前",
    },
    {
      id: "20",
      title: "推荐一些前端学习资源",
      agentName: "Nuwax",
      timeAgo: "2周前",
    },
  ]);

  // 点击会话项
  const handleItemClick = (item: ConversationItem) => {
    emit("conversation-click", item);
  };

  // 暴露方法供父组件调用
  defineExpose({
    // 可以暴露刷新数据等方法
  });
</script>

<style lang="scss" scoped>
  .conversation-list {
    background: #f5f5f5;

    .list-wrapper {
      padding: 0;

      .conversation-item {
        background: #fff;
        border-bottom: 1rpx solid #f0f0f0;
        padding: 32rpx 24rpx;
        transition: background-color 0.2s;

        &:active {
          background-color: #f8f8f8;
        }

        .item-content {
          .title-row {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16rpx;

            .conversation-title {
              flex: 1;
              font-size: 30rpx;
              font-weight: 600;
              color: #333;
              line-height: 42rpx;
              margin-right: 16rpx;
              overflow: hidden;
              text-overflow: ellipsis;
              white-space: nowrap;
            }

            .time-label {
              flex-shrink: 0;
              font-size: 24rpx;
              color: #999;
              line-height: 42rpx;
            }
          }

          .bottom-row {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;

            .agent-name {
              flex: 1;
              font-size: 26rpx;
              color: #999;
              overflow: hidden;
              text-overflow: ellipsis;
              white-space: nowrap;
            }

            .status-tag {
              flex-shrink: 0;
              background: #e6f7ff;
              border: 1rpx solid #91d5ff;
              border-radius: 4rpx;
              padding: 4rpx 12rpx;
              margin-left: 16rpx;

              .status-text {
                font-size: 22rpx;
                color: #1890ff;
                line-height: 28rpx;
              }
            }
          }
        }
      }
    }
  }

  .h-full {
    height: 100%;
  }
</style>
